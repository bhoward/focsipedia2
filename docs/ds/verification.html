<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-ds/verification" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Program Verification | FoCSipedia</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://bhoward.github.io/focsipedia2/img/focsipedia-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://bhoward.github.io/focsipedia2/img/focsipedia-social-card.jpg"><meta data-rh="true" property="og:url" content="https://bhoward.github.io/focsipedia2/docs/ds/verification"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Program Verification | FoCSipedia"><meta data-rh="true" name="description" content="How do you know that a program is correct?"><meta data-rh="true" property="og:description" content="How do you know that a program is correct?"><link data-rh="true" rel="icon" href="/focsipedia2/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://bhoward.github.io/focsipedia2/docs/ds/verification"><link data-rh="true" rel="alternate" href="https://bhoward.github.io/focsipedia2/docs/ds/verification" hreflang="en"><link data-rh="true" rel="alternate" href="https://bhoward.github.io/focsipedia2/docs/ds/verification" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://YNUYSORFOS-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Program Verification","item":"https://bhoward.github.io/focsipedia2/docs/ds/verification"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="FoCSipedia" href="/focsipedia2/opensearch.xml">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous"><link rel="stylesheet" href="/focsipedia2/assets/css/styles.715ccd98.css">
<script src="/focsipedia2/assets/js/runtime~main.e3bc9d5e.js" defer="defer"></script>
<script src="/focsipedia2/assets/js/main.7933b6b6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/focsipedia2/"><div class="navbar__logo"><img src="/focsipedia2/img/SmartFoxIcon.jpeg" alt="Smart Fox Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/focsipedia2/img/SmartFoxIcon.jpeg" alt="Smart Fox Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">FoCSipedia</b></a><a class="navbar__item navbar__link" href="/focsipedia2/docs/236topics">Topics</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/bhoward/focsipedia2/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/focsipedia2/docs/attribution">Course Info</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/focsipedia2/docs/logic/intro">Logic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/focsipedia2/docs/sets/concepts">Sets</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/focsipedia2/docs/fp/intro">Functional Programming</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/focsipedia2/docs/ds/lists">Lists, Trees, and Graphs</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/focsipedia2/docs/ds/lists">Sorting Lists</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/focsipedia2/docs/ds/recurrence">Running Time and Recurrences</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/focsipedia2/docs/ds/verification">Program Verification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/focsipedia2/docs/ds/trees">Trees</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/focsipedia2/docs/ds/bst">Binary Search Trees and Heaps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/focsipedia2/docs/ds/balance">Balanced Binary Search Trees</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/focsipedia2/docs/ds/graphs">Graphs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/focsipedia2/docs/ds/components">Connected Components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/focsipedia2/docs/ds/paths">Shortest Paths and Minimum Spanning Trees</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/focsipedia2/docs/lang/languages">Formal Languages</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/focsipedia2/docs/scala">Features</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/focsipedia2/docs/reason">Supplementary Topics</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/focsipedia2/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Lists, Trees, and Graphs</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Program Verification</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Program Verification</h1></header><p>How do you know that a program is correct?
The first issue is to decide what it even means for a program to be correct: if it isn&#x27;t
fully clear what the correct output should be for a given input, then we have no chance
of saying anything more definite than &quot;it looks OK&quot;.
Therefore, we will assume that we start with some sort of <strong>specification</strong>, whether
formal or informal, that will let us recognize correct output.</p>
<p>Given a specification, there is a wide spectrum of approaches to establishing the correctness
of a program:</p>
<ul>
<li>Do nothing and rely on the programmer to write code that works; this is clearly not reliable
or maintainable.</li>
<li>Provide informal arguments, perhaps in the form of <strong>comments</strong> embedded in the source code,
explaining how parts of the program work and correspond to the desired behavior; this may be
as far as some programmers go, and while it may be better in terms of maintainability, it
does not provide much additional assurance of correctness.</li>
<li>Create a suite of test cases, with sample inputs and expected outputs;
if a program passes its test suite, that gives some confidence that it might be correct, but
it can only tell about the particular cases that were in the suite; it provides no guarantees
about the behavior on untested cases.</li>
<li>Some aspects of a specification may be expressed in code in the form of <strong>assertions</strong>.
An assertion is a boolean expression that can be evaluated at some point of program execution;
if the result is <code>false</code>, then the assertion has failed.
You will only know this when the program is run on a particular input that triggers the failure;
this is analogous to dynamically typed languages like Python, where you will only find out about
a type violation when it actually occurs during program execution (potentially when it is in
production use by the client…).</li>
<li>One way to combine the previous two approaches is known as <strong>property-based testing</strong>, where
a testing tool will automatically generate a large number of test cases based on assertions
(&quot;properties&quot;) attached to the code. Again, passing a finite number of tests can never guarantee
the absence of bugs, because the tool might not happen to generate a particular failing case,
but good property-based testers can check a large range of common problem areas, such as
<strong>edge cases</strong> near extremely large or small inputs, or <strong>corner cases</strong> with unusual
combinations of inputs.</li>
<li>To gain full confidence that a program satisfies its specification, one can develop a
formal <strong>correctness proof</strong>. If successful, this provides a guarantee of correctness for all
possible program executions; again, this is analogous to strong statically typed languages
like Scala, where once the compiler confirms the types of all entities in advance, there
is no need to recheck them dynamically (during execution). Type checking can be thought of as
a simple form of correctness proof, where the assertions only make claims about
broad sets of possible values (the types).</li>
</ul>
<p>More details and examples of testing, assertions, properties, and correctness proofs are below.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a href="#testing" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">​</a></h2>
<p>The tests in a test suite can be on the level of individual functions to be tested in isolation
(<strong>unit testing</strong>), or they can be
at the level of a full program with inputs and outputs as seen by a user (<strong>integration testing</strong>).
In the following, we will only be looking at examples of unit testing.
Frequently the running of the test suite will be automated, so that the programmer will get
feedback after every change to know whether any of the test cases fail.</p>
<p>As noted above, testing can only confirm correct behavior on the cases where someone thought to
write a test.
This can still be valuable, particularly in the form of <strong>regression testing</strong>, where tests
are added to the suite whenever a bug is discovered—by adding a test that would
have failed because of the bug, passing the enhanced suite in the future will not only check that the
bug has been fixed (at least for that particular case), but also provides confidence that
further changes to the code do not reintroduce old bugs.</p>
<p>Here is an example (adapted from
<a href="https://github.com/anshulxyz/algorithms-scala/blob/main/src/test/scala/example/InsertionSortSpec.scala" target="_blank" rel="noopener noreferrer">this source</a>)
of using the <a href="https://www.scalatest.org" target="_blank" rel="noopener noreferrer">ScalaTest</a> framework to test some cases
of the <code>insertion_sort</code> function from <a href="/focsipedia2/docs/ds/lists">Sorting Lists</a>:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> InsertionSortSpec </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> AnyFlatSpec </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> Matchers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;Insertion Sort&quot;</span><span class="token plain"> should </span><span class="token string" style="color:#e3116c">&quot;sort a list of integers in ascending order&quot;</span><span class="token plain"> in </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> unsortedList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> sortedList   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    insertion_sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unsortedList</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> shouldEqual sortedList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  it should </span><span class="token string" style="color:#e3116c">&quot;handle an empty list&quot;</span><span class="token plain"> in </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    insertion_sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Nil</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> shouldEqual Nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  it should </span><span class="token string" style="color:#e3116c">&quot;handle a list with a single element&quot;</span><span class="token plain"> in </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> singleElementList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    insertion_sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">singleElementList</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> shouldEqual singleElementList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  it should </span><span class="token string" style="color:#e3116c">&quot;handle a list with duplicate elements&quot;</span><span class="token plain"> in </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> listWithDuplicates </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> sortedlist         </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    insertion_sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">listWithDuplicates</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> shouldEqual sortedlist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>The output when this is run with ScalaTest will look something like this:</p>
<pre><p>[info] <span style="color:green">InsertionSortSpec:</span>
[info] <span style="color:green">Insertion Sort</span>
[info] <span style="color:green">- should sort a list of integers in ascending order</span>
[info] <span style="color:green">- should handle an empty list</span>
[info] <span style="color:green">- should handle a list with a single element</span>
[info] <span style="color:green">- should handle a list with duplicate elements</span>
[info] <span style="color:teal">Run completed in 220 milliseconds.</span>
[info] <span style="color:teal">Total number of tests run: 4</span>
[info] <span style="color:teal">Suites: completed 1, aborted 0</span>
[info] <span style="color:teal">Tests: succeeded 4, failed 0, canceled 0, ignored 0, pending 0</span>
[info] <span style="color:green">All tests passed.</span></p></pre>
<p>Suppose we used this modified definition of <code>insert</code>, which does not retain duplicate elements:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nums</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  nums </span><span class="token keyword" style="color:#00009f">match</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> Nil </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> head </span><span class="token operator" style="color:#393A34">::</span><span class="token plain"> tail </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> head then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        n </span><span class="token operator" style="color:#393A34">::</span><span class="token plain"> nums</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> head then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        nums</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        head </span><span class="token operator" style="color:#393A34">::</span><span class="token plain"> insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tail</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Then the output for the same test suite would change to:</p>
<pre><p>[info] <span style="color:green">InsertionSortSpec:</span>
[info] <span style="color:green">Insertion Sort</span>
[info] <span style="color:green">- should sort a list of integers in ascending order</span>
[info] <span style="color:green">- should handle an empty list</span>
[info] <span style="color:green">- should handle a list with a single element</span>
[info] <span style="color:red">- should handle a list with duplicate elements *** FAILED ***</span>
[info] <span style="color:red">  List(1, 2, 3, 4, 5, 6, 9) did not equal List(1, 1, 2, 3, 4, 5, 5, 6, 9) (InsertionSortSpec.scala:23)</span>
[info] <span style="color:red">  Analysis:</span>
[info] <span style="color:red">  List(1: 2 -&gt; 1, 2: 3 -&gt; 2, 3: 4 -&gt; 3, 4: 5 -&gt; 4, 5: 6 -&gt; 5, 6: 9 -&gt; 5, 7: -&gt; 6, 8: -&gt; 9)</span>
[info] <span style="color:teal">Run completed in 246 milliseconds.</span>
[info] <span style="color:teal">Total number of tests run: 4</span>
[info] <span style="color:teal">Suites: completed 1, aborted 0</span>
[info] <span style="color:teal">Tests: succeeded 3, failed 1, canceled 0, ignored 0, pending 0</span>
[info] <span style="color:red">*** 1 TEST FAILED ***</span></p></pre>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="assertions">Assertions<a href="#assertions" class="hash-link" aria-label="Direct link to Assertions" title="Direct link to Assertions">​</a></h2>
<p>As stated above, an assertion is a boolean expression that must be <code>true</code> each time it is encountered
during program execution.
For example, in the <a href="/focsipedia2/docs/ds/lists">Sorting Lists</a> section, the <code>select</code> function used in selection
sort requires that the input list be non-empty, and the <code>insert</code> function used in insertion sort
requires that the input list be ordered.
Each of these <strong>preconditions</strong> could be checked by an assertion (note that the original code
only had these preconditions in the form of comments; we are assuming here the existence of a
function <code>isSorted</code> that checks whether a list is in order):</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/* Precondition: nums is non-empty */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> select</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nums</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  assert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">nums</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isEmpty</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/* Precondition: nums is sorted in non-decreasing order */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nums</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  assert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isSorted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nums</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Instead of a precondition, which asserts a property of the input to a function, assertions
are often used for <strong>postconditions</strong> and <strong>invariants</strong>.
A postcondition asserts a claim about the output of a function; the combination of
pre- and postconditions are often referred to as the <strong>contract</strong> of a function (just
like the signature of a function establishes a contract at the level of types).
In the sorting functions, one reasonable postcondition is that the output is in order.
This can be expressed in Scala by adding an <code>ensuring</code> clause after the function body:</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> insertion_sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nums</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  nums </span><span class="token keyword" style="color:#00009f">match</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> Nil </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"> Nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> head </span><span class="token operator" style="color:#393A34">::</span><span class="token plain"> tail </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"> insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">insertion_sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tail</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> head</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> ensuring </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  isSorted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>Note that the argument to <code>ensuring</code> is an anonymous function value that will be applied to the
result of the preceding expression; our convention will be to use the parameter name
<code>result</code> in this anonymous function, because it gives us a way to refer to the output of
the function by name.</p>
<p>An invariant asserts that a property is true each time an arbitrary point of the program is
reached.
This is most commonly used in conjunction with loops and mutable variables; since a pure
functional approach to Scala discourages such constructs, here is an example in Java:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/** Compute a * b using only addition.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Precondition: b &gt;= 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">times</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">assert</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">assert</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">assert</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Each time we enter the loop, the invariant assures us that the current value of <code>result</code> is
the same as <code>a</code> times the current value of <code>i</code>.
Since the loop exits when <code>i == b</code>, we can use this invariant to establish the desired
postcondition that <code>result</code> is <code>a * b</code>.
When we run this Java program with the <code>-ea</code> (&quot;enable assertions&quot;) flag, it will check that
each <code>assert</code> line evaluates to <code>true</code>.</p>
<p>In Scala, if an assertion fails it will throw an error and halt the program with a
message describing the failure.
Because of this abrupt reaction, and because the evaluation of assertions might take a significant
amount of the program&#x27;s running time (consider how long it would take to check that <code>nums</code>
is sorted on each call to <code>insert</code> while sorting a long list), it is common practice to only
&quot;turn on&quot; assertion checking as part of the debugging process.
By passing an appropriate option to the Scala compiler, a release version of the program
can be generated where the <code>assert</code> statements have been removed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="property-testing">Property Testing<a href="#property-testing" class="hash-link" aria-label="Direct link to Property Testing" title="Direct link to Property Testing">​</a></h2>
<p>By combining testing with properties, we can have the best features of both.
<strong>Property-based testing</strong> lets us specify general properties that need to hold,
but instead of checking them at runtime with assertions (which we do <strong>not</strong> want to
do in production) we test them in advance by running a tool that will generate a
large number of &quot;random&quot; cases and checking each of the properties.
In effect, this automates the process of generating unit tests.</p>
<p>The property testing tool knows the types of the data being tested, and can
generate a suitable range of &quot;arbitrary&quot; values.
A typical tool is <a href="https://scalacheck.org/" target="_blank" rel="noopener noreferrer">ScalaCheck</a>, which has built-in
generators for primitive types and standard collections; in addition to randomly
generated values, it will also try common edge cases (such as <code>Int.MaxValue</code> and
the empty list).
For custom data types, such as trees, it provides facilities to define new generators.</p>
<p>Here is an example of some properties written in ScalaCheck that will test the
behavior of our insertion sort function.
These properties are written in the form <code>forAll {(a: T) =&gt; P(a)}</code>, which is the
signal to ScalaCheck that it should generate arbitrary values <code>a</code> of type <code>T</code>
(by default, it generates 100 of them), and check whether the boolean expression
<code>P(a)</code> is <code>true</code>.<sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup></p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">object</span><span class="token plain"> InsertionSortPropSpec </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> Properties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Insertion Sort&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Prop</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">forAll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  property</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;same length&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> forAll </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> insertion_sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  property</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;sorted&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> forAll </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    isSorted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">insertion_sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  property</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;same elements&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> forAll </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">val</span><span class="token plain"> aSorted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> insertion_sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">forall</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"> aSorted contains x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> aSorted</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">forall</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"> a contains x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>When run with ScalaCheck, the output from this will be</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+ Insertion Sort.same length: OK, passed 100 tests.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ Insertion Sort.sorted: OK, passed 100 tests.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ Insertion Sort.same elements: OK, passed 100 tests.</span><br></span></code></pre></div></div>
<p>If we run it on the faulty version of insertion sort that discards duplicates, the output
might instead be</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">! Insertion Sort.same length: Falsified after 5 passed tests.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; ARG_0: List(&quot;0&quot;, &quot;0&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; ARG_0_ORIGINAL: List(&quot;0&quot;, &quot;2147483647&quot;, &quot;-30181727&quot;, &quot;0&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ Insertion Sort.sorted: OK, passed 100 tests.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ Insertion Sort.same elements: OK, passed 100 tests.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Found 1 failing properties.</span><br></span></code></pre></div></div>
<p>Note that it first found a failing input: <code>List(0, 2147483647, -30181727, 0)</code>.
A common ability of property-based testers is that once a failing case is found,
it will then attempt to generate simpler related cases until it finds a
minimal counterexample.
In this run, ScalaCheck was able to shrink the failing case down to <code>List(0, 0)</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="correctness-proofs">Correctness Proofs<a href="#correctness-proofs" class="hash-link" aria-label="Direct link to Correctness Proofs" title="Direct link to Correctness Proofs">​</a></h2>
<p>In some cases it is possible to go further than just checking that properties hold for
a sampling of values.
If we can construct a logical proof which establishes that the desired postcondition
follows from the precondition and the body of each function, then we will have an
absolute guarantee that the code satisfies its specification.</p>
<p>The compositional nature of functional programming really shines here, because it is
<em>much</em> easier to complete this sort of formal correctness proof when working with
pure functions, where we do not have to worry about tracking the current state of mutable variables.
With that said, all is not lost for imperative code, but we will need more powerful techniques
(see for example <a href="https://en.wikipedia.org/wiki/Hoare_logic" target="_blank" rel="noopener noreferrer">Hoare Logic</a>) to reason about state.</p>
<p>The <a href="https://epfl-lara.github.io/stainless/" target="_blank" rel="noopener noreferrer">Stainless</a> framework is one tool (another is
<a href="https://logika.sireum.org/" target="_blank" rel="noopener noreferrer">Sireum Logika</a>) for verifying the behavior of Scala programs.
It works by extracting <strong>verification conditions</strong> (VCs) from a (subset of) Scala program that has
been augmented with pre- and postconditions as we saw in the <a href="#assertions">Assertions</a> section
(except for technical reasons we use <code>require</code> instead of <code>assert</code> for the precondition).
Stainless also generates VCs for Scala features such as pattern matching, to ensure that there
are cases to cover all of the possible values; it also generates conditions that assert that
the program will terminate and not loop forever—this is a stronger statement: not only will
it not produce an incorrect result, it will actually produce a correct result!
It then hands these VCs over to an automated theorem prover (by default, the
<a href="https://en.wikipedia.org/wiki/Z3_Theorem_Prover" target="_blank" rel="noopener noreferrer">Z3</a> prover from Microsoft) and attempts to
find a proof using techniques such as <a href="/focsipedia2/docs/logic/induction">induction</a>.</p>
<p>Here is an example of our insertion sort code with appropriate pre- and postconditions
(the code is slightly different, mostly around the pattern-matching on lists, because
Stainless relies on its own library of basic data types which already have a large number
of useful properties established):</p>
<div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nums</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isSorted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nums</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  nums </span><span class="token keyword" style="color:#00009f">match</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> Nil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> Cons</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tail</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> head then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        n </span><span class="token operator" style="color:#393A34">::</span><span class="token plain"> nums</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        head </span><span class="token operator" style="color:#393A34">::</span><span class="token plain"> insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tail</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> ensuring </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  isSorted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">content </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> nums</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">content </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">size </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> nums</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">size </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> insertion_sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nums</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">Int</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  nums </span><span class="token keyword" style="color:#00009f">match</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> Nil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"> Nil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> Cons</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tail</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"> insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">insertion_sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tail</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> head</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> ensuring </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result </span><span class="token keyword" style="color:#00009f">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  isSorted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">content </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> nums</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">content </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">size </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> nums</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>Running this through Stainless leads to sucessfully generating proofs of 17 verification conditions,
establishing that the code will correctly sort any possible list of ints.</p>
<pre><p>[<span style="color:blue">  Info  </span>]   ┌───────────────────┐
[<span style="color:blue">  Info  </span>] ╔═╡ <span style="color:green">stainless summary</span> ╞═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
[<span style="color:blue">  Info  </span>] ║ └───────────────────┘                                                                                                                                 ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:10:7: </span>   <span style="color:green">insert</span>          <span style="color:green">non-negative measure</span>                                      <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.1</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:13:5: </span>   <span style="color:green">insert</span>          <span style="color:green">body assertion: match exhaustiveness</span>                      <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.0</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:13:5: </span>   <span style="color:green">insert</span>          <span style="color:green">postcondition</span>                                             <span style="color:green">valid from cache</span>  <span style="color:green"></span>          <span style="color:green">0.0</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:14:26: </span>  <span style="color:green">insert</span>          <span style="color:green">postcondition</span>                                             <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.1</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:17:11: </span>  <span style="color:green">insert</span>          <span style="color:green">postcondition</span>                                             <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.1</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:19:11: </span>  <span style="color:green">insert</span>          <span style="color:green">postcondition</span>                                             <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.2</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:19:19: </span>  <span style="color:green">insert</span>          <span style="color:green">measure decreases</span>                                         <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.1</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:19:19: </span>  <span style="color:green">insert</span>          <span style="color:green">precond. (call insert((scrut.t): @DropVCs , n))</span>           <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.0</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:26:7: </span>   <span style="color:green">insertion_sort</span>  <span style="color:green">non-negative measure</span>                                      <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.0</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:27:5: </span>   <span style="color:green">insertion_sort</span>  <span style="color:green">body assertion: match exhaustiveness</span>                      <span style="color:green">trivial</span>           <span style="color:green"></span>          <span style="color:green">0.0</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:27:5: </span>   <span style="color:green">insertion_sort</span>  <span style="color:green">postcondition</span>                                             <span style="color:green">trivial</span>           <span style="color:green"></span>          <span style="color:green">0.0</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:28:21: </span>  <span style="color:green">insertion_sort</span>  <span style="color:green">postcondition</span>                                             <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.1</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:29:32: </span>  <span style="color:green">insertion_sort</span>  <span style="color:green">postcondition</span>                                             <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.2</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:29:32: </span>  <span style="color:green">insertion_sort</span>  <span style="color:green">precond. (call insert(insertion_sort((scrut.t): @Dro...)</span>  <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.3</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:29:39: </span>  <span style="color:green">insertion_sort</span>  <span style="color:green">measure decreases</span>                                         <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.1</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:5:7: </span>    <span style="color:green">isSorted</span>        <span style="color:green">non-negative measure</span>                                      <span style="color:green">valid from cache</span>  <span style="color:green"></span>          <span style="color:green">0.0</span> ║
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">src/main/scala/InsertionSort.scala:6:48: </span>   <span style="color:green">isSorted</span>        <span style="color:green">measure decreases</span>                                         <span style="color:green">valid</span>             <span style="color:green">U<!-- -->:smt-z3</span>  <span style="color:green">0.0</span> ║
[<span style="color:blue">  Info  </span>]   ╟┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄╢
[<span style="color:blue">  Info  </span>] ║ <span style="color:green">total: 17   valid: 17   (2 from cache, 2 trivial) invalid: 0    unknown: 0    time:    1.26</span>                                                           ║
[<span style="color:blue">  Info  </span>] ╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝</p></pre>
<p>As a sample of one of the VCs, here is what it generates for the <code>insert</code> function
in the case where the number to be inserted, <code>n</code>, is less than or equal to the head of
the (non-empty) list, <code>nums</code>:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∀</mi><mtext mathvariant="monospace">nums</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">n</mtext><mrow><mo fence="true">(</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext mathvariant="monospace">isSorted(nums)</mtext><mo>∧</mo><mi mathvariant="normal">¬</mi><mtext mathvariant="monospace">nums.isEmpty</mtext><mo>∧</mo><mtext mathvariant="monospace">n</mtext><mo>≤</mo><mtext mathvariant="monospace">nums.head</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext mathvariant="monospace">isSorted(result)</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>∧</mo><mtext> </mtext><mtext mathvariant="monospace">result.content</mtext><mo>=</mo><mtext mathvariant="monospace">nums.content</mtext><mo>∪</mo><mtext mathvariant="monospace">n</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>∧</mo><mtext> </mtext><mtext mathvariant="monospace">result.size</mtext><mo>=</mo><mtext mathvariant="monospace">nums</mtext><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext mathvariant="italic">where</mtext><mspace width="1em"></mspace><mtext mathvariant="monospace">result</mtext><mo>=</mo><mrow><mtext mathvariant="monospace">n</mtext><mtext> </mtext><mtext mathvariant="monospace">::</mtext><mtext> </mtext><mtext mathvariant="monospace">nums</mtext></mrow></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\forall\texttt{nums}, \texttt{n}\left(
\begin{array}{c}
    \texttt{isSorted(nums)}\land\lnot\texttt{nums.isEmpty}\land\texttt{n}\leq\texttt{nums.head}\\
    \implies\\
    \texttt{isSorted(result)}\\
    \land\ \texttt{result.content}=\texttt{nums.content}\cup\texttt{n}\\
    \land\ \texttt{result.size}=\texttt{nums}+1\\
    \textit{where}\quad\texttt{result}=\texttt{n :: nums}
\end{array}
\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.2001em;vertical-align:-3.35em"></span><span class="mord">∀</span><span class="mord text"><span class="mord texttt">nums</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord text"><span class="mord texttt">n</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.85em"><span style="top:-5.8499em"><span class="pstrut" style="height:9.2em"></span><span style="width:0.875em;height:7.200em"><svg xmlns="http://www.w3.org/2000/svg" width="0.875em" height="7.200em" viewBox="0 0 875 7200"><path d="M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,3684c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-3692c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.85em"><span style="top:-6.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord texttt">isSorted(nums)</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">¬</span><span class="mord text"><span class="mord texttt">nums.isEmpty</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord texttt">n</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord texttt">nums.head</span></span></span></span><span style="top:-4.81em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">⟹</span><span class="mspace" style="margin-right:0.2778em"></span></span></span><span style="top:-3.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord texttt">isSorted(result)</span></span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∧</span><span class="mspace"> </span><span class="mord text"><span class="mord texttt">result.content</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord texttt">nums.content</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord texttt">n</span></span></span></span><span style="top:-1.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∧</span><span class="mspace"> </span><span class="mord text"><span class="mord texttt">result.size</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord texttt">nums</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:-0.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord textit">where</span></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord texttt">result</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord texttt">n :: nums</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.85em"><span style="top:-5.8499em"><span class="pstrut" style="height:9.2em"></span><span style="width:0.875em;height:7.200em"><svg xmlns="http://www.w3.org/2000/svg" width="0.875em" height="7.200em" viewBox="0 0 875 7200"><path d="M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,3609
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-3744c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>This may be proved directly from facts about <code>isSorted</code>, <code>content</code>, and <code>size</code>.
The case where <code>n</code> is greater than the head of <code>nums</code> is similar, but it requires induction
to assume properties of the recursive call to insert <code>n</code> in the tail of <code>nums</code>:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∀</mi><mtext mathvariant="monospace">nums</mtext><mo separator="true">,</mo><mtext mathvariant="monospace">n</mtext><mrow><mo fence="true">(</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext mathvariant="monospace">isSorted(nums)</mtext><mo>∧</mo><mi mathvariant="normal">¬</mi><mtext mathvariant="monospace">nums.isEmpty</mtext><mo>∧</mo><mtext mathvariant="monospace">n</mtext><mo>&gt;</mo><mtext mathvariant="monospace">nums.head</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext mathvariant="monospace">isSorted(result)</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>∧</mo><mtext> </mtext><mtext mathvariant="monospace">result.content</mtext><mo>=</mo><mtext mathvariant="monospace">nums.content</mtext><mo>∪</mo><mtext mathvariant="monospace">n</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>∧</mo><mtext> </mtext><mtext mathvariant="monospace">result.size</mtext><mo>=</mo><mtext mathvariant="monospace">nums</mtext><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext mathvariant="italic">where</mtext><mspace width="1em"></mspace><mtext mathvariant="monospace">result</mtext><mo>=</mo><mrow><mtext mathvariant="monospace">nums.head</mtext><mtext> </mtext><mtext mathvariant="monospace">::</mtext><mtext> </mtext><mtext mathvariant="monospace">insert(nums.tail,</mtext><mtext> </mtext><mtext mathvariant="monospace">n)</mtext></mrow></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\forall\texttt{nums}, \texttt{n}\left(
\begin{array}{c}
    \texttt{isSorted(nums)}\land\lnot\texttt{nums.isEmpty}\land\texttt{n}&gt;\texttt{nums.head}\\
    \implies\\
    \texttt{isSorted(result)}\\
    \land\ \texttt{result.content}=\texttt{nums.content}\cup\texttt{n}\\
    \land\ \texttt{result.size}=\texttt{nums}+1\\
    \textit{where}\quad\texttt{result}=\texttt{nums.head :: insert(nums.tail, n)}
\end{array}
\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.2001em;vertical-align:-3.35em"></span><span class="mord">∀</span><span class="mord text"><span class="mord texttt">nums</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord text"><span class="mord texttt">n</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.85em"><span style="top:-5.8499em"><span class="pstrut" style="height:9.2em"></span><span style="width:0.875em;height:7.200em"><svg xmlns="http://www.w3.org/2000/svg" width="0.875em" height="7.200em" viewBox="0 0 875 7200"><path d="M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,3684c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-3692c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.85em"><span style="top:-6.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord texttt">isSorted(nums)</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">¬</span><span class="mord text"><span class="mord texttt">nums.isEmpty</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord texttt">n</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord texttt">nums.head</span></span></span></span><span style="top:-4.81em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">⟹</span><span class="mspace" style="margin-right:0.2778em"></span></span></span><span style="top:-3.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord texttt">isSorted(result)</span></span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∧</span><span class="mspace"> </span><span class="mord text"><span class="mord texttt">result.content</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord texttt">nums.content</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord texttt">n</span></span></span></span><span style="top:-1.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∧</span><span class="mspace"> </span><span class="mord text"><span class="mord texttt">result.size</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord texttt">nums</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:-0.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord textit">where</span></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord texttt">result</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord texttt">nums.head :: insert(nums.tail, n)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.85em"><span style="top:-5.8499em"><span class="pstrut" style="height:9.2em"></span><span style="width:0.875em;height:7.200em"><svg xmlns="http://www.w3.org/2000/svg" width="0.875em" height="7.200em" viewBox="0 0 875 7200"><path d="M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,3609
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-3744c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>We are still limited by the detail of our specification.
For example, we have not specified anything here about the running time or stack depth needed for this code;
indeed, we know that this particular example will crash with a stack overflow if the list is too long,
because it is not written in tail-recursive style.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercises">Exercises<a href="#exercises" class="hash-link" aria-label="Direct link to Exercises" title="Direct link to Exercises">​</a></h2>
<p>TBD</p>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-1">
<p>Note that the ScalaCheck <code>forAll</code> function is different from the method
<code>forall</code> defined on lists in Scala (and used in the &quot;same elements&quot; property),
which maps a predicate over all of the elements of the given list and then
&quot;ands&quot; the results together. <a href="#user-content-fnref-1" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/bhoward/focsipedia2/edit/main/docs/ds/verification.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/focsipedia2/docs/ds/recurrence"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Running Time and Recurrences</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/focsipedia2/docs/ds/trees"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Trees</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#testing" class="table-of-contents__link toc-highlight">Testing</a></li><li><a href="#assertions" class="table-of-contents__link toc-highlight">Assertions</a></li><li><a href="#property-testing" class="table-of-contents__link toc-highlight">Property Testing</a></li><li><a href="#correctness-proofs" class="table-of-contents__link toc-highlight">Correctness Proofs</a></li><li><a href="#exercises" class="table-of-contents__link toc-highlight">Exercises</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/focsipedia2/docs/policies">Policies</a></li><li class="footer__item"><a class="footer__link-item" href="/focsipedia2/docs/attribution">Attribution</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/bhoward/focsipedia2/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 <a href="https://github.com/bhoward">Brian T. Howard</a>. Built with <a href="https://docusaurus.io/">Docusaurus</a>. <a href="https://purl.org/focsipedia">FoCSipedia</a> is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg" alt=""></a></div></div></div></footer></div>
</body>
</html>